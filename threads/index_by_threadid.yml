rules:
  - id: index-by-threadid
    pattern-either:
      - pattern: |
          $TID = Threads.threadid()
          ...
          $X = $S[$TID]
      - pattern: |
          $TID = threadid()
          ...
          $X = $S[$TID]
      - pattern: $S[threadid()]
      - pattern: $S[Threads.threadid()]
    message: Indexing by `threadid()` may cause race conditions and should be avoided.
    metadata:
      references:
        - https://www.julialang.org/blog/2023/07/PSA-dont-use-threadid/
      license: LGPL
    languages:
      - julia
    severity: WARNING
