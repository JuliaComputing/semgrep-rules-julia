rules:
  - id: index-by-threadid
    pattern-either:
      - pattern: |
          $TID = Threads.threadid()
          ...
          $X = $S[$TID]
      - pattern: |
          $TID = threadid()
          ...
          $X = $S[$TID]
      - pattern: $S[threadid()]
      - pattern: $S[Threads.threadid()]
    message: Indexing by `threadid()` may cause race conditions and should be avoided.
    metadata:
      references:
        - https://github.com/JuliaLang/www.julialang.org/pull/1904
      license: LGPL
    languages:
      - julia
    severity: WARNING
